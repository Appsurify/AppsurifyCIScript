# Appsurify CI Script

## Available arguments
 
### Required arguments 

| argument | options |
| --- | --- |
| apikey | apikey from appsurify |
| url | url of the appsurify instance i.e. "https://dummy.appsurify.com" do not end with a / |
| project | name of the project |
| testsuite | name of the testsuite |
| report | location of the reports generated by the test run, end with a / for directories or .xml for specific files |
  
### Optional Arguments 

| argument | default | options/details |
| --- | --- | --- |
| startrun |  | command to start the test run, may need to end with a space |
| endrun |  | command to end the test run, may need to start with a space |
| maxtests | default 10000000 | the maximum number of tests to run in each test execution set | 
| fail | newdefects, reopeneddefects | options newdefects, reopeneddefects, flakybrokentests, newflaky, reopenedflaky, failedtests, brokentests |
| additionalargs | "" |   |    
| testseparator | "" | #string or character used to separate tests when creating the command to run a specific set of tests |  
| postfixtest | "" | #string to postpend to each test  when creating the command to run a specific set of tests |
| prefixtest | "" | string to prepend to each test  when creating the command to run a specific set of tests |
| fullnameseparator | " " | string or character to separate classname and testname when creating the command to run a specific set of tests |
| fullname | "false" | whether to include the classname when creating the command to run a specific set of tests |
| rerun | "false" | whether failed tests should be rerun |
| maxrerun | 3 | the number of times failed tests should be rerun |
| failfast | "false" | whether after each set of test runs to determine if the build has failed (tests will still be rerun if this has been selected) |
| importtype | "junit" | #options junit or nunit xml files |
| reporttype | "directory" | default directory must end with a /, will look for all xml files in that directory |
| deletereports | "false" | options true or false, BE CAREFUL THIS WILL DELETE THE SPECIFIC FILE OR ALL XML FILES IN THE DIRECTORY |
| commitId | git log -1 --pretty="%H | commitId that this test run is for, if not supplied the script will use git log -1 --pretty="%H |
| teststorun | "all" | #options include - high, medium, low, unassigned, ready, open, none.   We recommend initially running all your tests and just pushing the results to Appsurify. To do this choose either "all" and use this script to run the tests, or choose none and use this script to just upload the results. Once you have either selected the coverage of the tests or uploaded a number of test reults for Appsurify to learn from select Appsurify recommended and choose from the options where - high = most likely to fail, covers the exact change, medium = less likely to fail, covers the functional area or dependencies, low = very unlikely to fail, does not cover the change, unassigned = tests where Appsurify is unsure whether the coverage of these tests, ready defects = tests which have a defect associated with them which is ready for testing, open defects = tests which have a defect associated with them which is open. |
  

### Examples

#### Java All Tests
RunTestsWithAppsurify.sh --url "https://dummy.appsurify.com" --apikey "Kasdfasdfasdfasdfasdfasdfadsfasdfasdfasdf" --project "Test" --testsuite "Test" --report "report" --teststorun "all" --startrun "mvn test" 

#### Java High Tests
RunTestsWithAppsurify.sh --url "https://dummy.appsurify.com" --apikey "Kasdfasdfasdfasdfasdfasdfadsfasdfasdfasdf" --project "Test" --testsuite "Test" --report "report" --teststorun "high,medium" --startrun "mvn -Dtest=" --fullname "true" --fullnameseparator "#" --endrun " test" --testseparator ","


#### Rspec all tests
https://github.com/sj26/rspec_junit_formatter must be installed
Startrun="rspec --format RspecJunitFormatter --out rspec.xml"


#### Rspec specific tests
RunTestsWithAppsurify.sh --url "https://dummy.appsurify.com" --apikey "Kasdfasdfasdfasdfasdfasdfadsfasdfasdfasdf" --project "Test" --testsuite "Test" --report "rspec.xml" --teststorun "high,medium" --startrun "rspec --format RspecJunitFormatter --out rspec.xml -e '" --endrun = "'" --testseparator "' -e '"
https://relishapp.com/rspec/rspec-core/docs/command-line/example-option
